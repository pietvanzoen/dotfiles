#!/bin/bash
# Update master and prune any merged/gone branches

set -e

exe() { echo "==> $@" ; $@ ; }

if [[ ! -z "$(git status -s)" ]]; then
  echo "commit changes before running tidy"
  exit 1
fi

exe "git checkout master"
exe "git fetch --all --prune"
exe "git pull --rebase"
exe "git prune-merged"
exe "git prune-gone"
